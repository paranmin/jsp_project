drop database mall;

create database mall;

use mall;

CREATE TABLE `mall`.`admin_board` (
  `ab_no` int(11) NOT NULL COMMENT '게시판번호',
  `ab_code` varchar(20) NOT NULL COMMENT '게시판코드',
  `ab_name` varchar(50) NOT NULL COMMENT '게시판이름',
  `ab_use` char(1) DEFAULT NULL COMMENT '사용유무',
  PRIMARY KEY (`ab_no`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='게시판 생성정보';

CREATE TABLE `mall`.`board` (
  `brd_no` int(11) NOT NULL COMMENT '글번호',
  `brd_code` varchar(20) NOT NULL COMMENT '게시판코드',
  `brd_title` varchar(50) NOT NULL COMMENT '글 제목',
  `brd_content` text NOT NULL COMMENT '글 내용',
  `brd_parent` int(11) NOT NULL COMMENT '글 부모',
  `brd_depth` int(11) NOT NULL COMMENT '글 깊이',
  `brd_use_attachment` char(1) DEFAULT NULL COMMENT '첨부파일유무',
  `prd_no` int(11) DEFAULT NULL COMMENT '상품번호',
  PRIMARY KEY (`brd_no`),
  KEY `FK_product_TO_board` (`prd_no`),
  CONSTRAINT `FK_product_TO_board` FOREIGN KEY (`prd_no`) REFERENCES `product` (`prd_no`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='게시판';

CREATE TABLE `mall`.`board_attachment` (
  `baf_no` int(11) NOT NULL COMMENT '첨부파일번호',
  `baf_name` varchar(50) NOT NULL COMMENT '파일이름',
  `baf_path` varchar(200) NOT NULL COMMENT '파일경로',
  `baf_extension` varchar(10) DEFAULT NULL COMMENT '파일 확장자',
  `brd_no` int(11) DEFAULT NULL COMMENT '글번호',
  PRIMARY KEY (`baf_no`),
  KEY `FK_board_TO_board_attachment` (`brd_no`),
  CONSTRAINT `FK_board_TO_board_attachment` FOREIGN KEY (`brd_no`) REFERENCES `board` (`brd_no`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='게시판 첨부파일';

CREATE TABLE `mall`.`cart` (
  `m_no` int(11) DEFAULT NULL COMMENT '회원번호',
  KEY `FK_member_TO_cart` (`m_no`),
  CONSTRAINT `FK_member_TO_cart` FOREIGN KEY (`m_no`) REFERENCES `member` (`m_no`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='장바구니';

CREATE TABLE `mall`.`member` (
  `m_no` int(11) NOT NULL COMMENT '회원번호',
  `m_id` varchar(50) NOT NULL COMMENT '회원ID',
  `m_name` varchar(50) NOT NULL COMMENT '회원이름',
  `m_pass` varchar(50) NOT NULL COMMENT '회원비밀번호',
  `m_email` varchar(40) NOT NULL COMMENT '회원이메일',
  `m_phone` varchar(30) NOT NULL COMMENT '회원전화번호',
  `m_regdate` datetime DEFAULT NULL COMMENT '가입일',
  PRIMARY KEY (`m_no`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='회원';

CREATE TABLE `mall`.`member_detail` (
  `m_no` int(11) NOT NULL COMMENT '회원번호',
  `md_zipcode` int(11) DEFAULT NULL COMMENT '우편번호',
  `md_address` varchar(255) DEFAULT NULL COMMENT '주소',
  PRIMARY KEY (`m_no`),
  CONSTRAINT `FK_member_TO_member_detail` FOREIGN KEY (`m_no`) REFERENCES `member` (`m_no`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='회원상세정보';

CREATE TABLE `mall`.`order` (
  `ord_no` varchar(20) NOT NULL COMMENT '주문번호',
  `ord_display_price` int(11) NOT NULL COMMENT '주문표시가격',
  `ord_real_price` int(11) NOT NULL COMMENT '주문실제가격',
  `ord_pay_type` char(1) NOT NULL COMMENT '결제타입',
  `ord_use_prd_option` char(1) DEFAULT NULL COMMENT '주문상품옵션유무',
  `ord_delivery_fee` int(11) NOT NULL COMMENT '배송비',
  `m_no` int(11) NOT NULL COMMENT '회원번호',
  PRIMARY KEY (`ord_no`),
  KEY `FK_member_TO_order` (`m_no`),
  CONSTRAINT `FK_member_TO_order` FOREIGN KEY (`m_no`) REFERENCES `member` (`m_no`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='주문정보';

CREATE TABLE `mall`.`order_product` (
  `op_selling_price` int(11) NOT NULL COMMENT '판매가',
  `op_quantity` int(11) NOT NULL COMMENT '상품수량',
  `op_option` varchar(100) DEFAULT NULL COMMENT '상품옵션',
  `ord_no` varchar(20) DEFAULT NULL COMMENT '주문번호',
  `prd_no` int(11) DEFAULT NULL COMMENT '상품번호',
  KEY `FK_order_TO_order_product` (`ord_no`),
  KEY `FK_product_TO_order_product` (`prd_no`),
  CONSTRAINT `FK_order_TO_order_product` FOREIGN KEY (`ord_no`) REFERENCES `order` (`ord_no`),
  CONSTRAINT `FK_product_TO_order_product` FOREIGN KEY (`prd_no`) REFERENCES `product` (`prd_no`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='주문상품';

CREATE TABLE `mall`.`product` (
  `prd_no` int(11) NOT NULL COMMENT '상품번호',
  `prd_name` varchar(50) NOT NULL COMMENT '상품명',
  `prd_sub_desc` varchar(255) DEFAULT NULL COMMENT '상품부가설명',
  `prd_cost` int(11) NOT NULL COMMENT '원가',
  `prd_selling_price` int(11) NOT NULL COMMENT '판매가',
  `prd_discount_per` char(1) DEFAULT NULL COMMENT '할인율',
  `prd_content` text COMMENT '상세설명',
  `prd_use_option` char(1) DEFAULT NULL COMMENT '옵션유무',
  `prd_stock` int(11) DEFAULT NULL COMMENT '상품재고',
  PRIMARY KEY (`prd_no`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='상품';

alter table product add (use_discount char(1) DEFAULT NULL);
alter table product add (prd_main_img text NOT NULL);

CREATE TABLE `mall`.`product_option` (
  `po_no` int(11) NOT NULL COMMENT '옵션번호',
  `po_name` varchar(50) NOT NULL COMMENT '옵션명',
  `po_desc` varchar(255) DEFAULT NULL COMMENT '옵션설명',
  `po_parent` int(11) NOT NULL COMMENT '옵션부모',
  `po_depth` int(11) NOT NULL COMMENT '옵션깊이',
  `prd_no` int(11) NOT NULL COMMENT '상품번호',
  PRIMARY KEY (`po_no`),
  KEY `FK_product_TO_product_option` (`prd_no`),
  CONSTRAINT `FK_product_TO_product_option` FOREIGN KEY (`prd_no`) REFERENCES `product` (`prd_no`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='상품옵션';

CREATE TABLE `mall`.`product_option_detail` (
  `po_no` int(11) NOT NULL COMMENT '옵션번호',
  `pod_detail` varchar(255) DEFAULT NULL COMMENT '옵션상세설명',
  KEY `FK_product_option_TO_product_option_detail` (`po_no`),
  CONSTRAINT `FK_product_option_TO_product_option_detail` FOREIGN KEY (`po_no`) REFERENCES `product_option` (`po_no`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='상품옵션정보';
